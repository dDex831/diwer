<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>浩軒產品互動版｜入口</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="在 LINE 中開啟浩軒互動版，可加入心願單並分享；或改看純網頁版。">
  <meta name="keywords" content="浩軒, 客製化禮品, 企業贈品, 帆布袋, 保冷袋, LINE 分享, LIFF">
  <meta property="og:title" content="浩軒產品互動版">
  <meta property="og:description" content="在 LINE 中開啟浩軒互動版，可加入心願單並分享。">
  <meta property="og:image" content="https://www.diwer.me/images-web/浩軒13.6.png">
  <link rel="icon" type="image/png" sizes="32x32" href="images-web/浩軒13.6.png">
  <link rel="Diwer-icon" sizes="180x180" href="images-web/浩軒13.6.png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500;700&display=swap" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
  <style>
    body{margin:0;background:#f6f1ee;color:#333;font-family:system-ui,"Noto Sans TC",sans-serif;text-align:center;line-height:1.4;}
    #open-external-tip{display:none;background:#fffae6;padding:8px;text-align:center;font-size:14px;border-bottom:1px solid #ddd;}
    .hx-launch-wrap{max-width:480px;margin:0 auto;padding:48px 16px 72px;}
    .hx-launch-logo{width:96px;height:auto;margin-bottom:16px;}
    .hx-launch-title{font-size:1.4rem;margin:0 0 8px;font-weight:700;}
    .hx-launch-desc{font-size:1rem;margin:0 0 24px;line-height:1.5;}
    .hx-launch-btn{display:block;width:100%;max-width:320px;margin:0 auto 16px;padding:16px 0;font-size:1.1rem;font-weight:600;border:none;border-radius:8px;cursor:pointer;text-decoration:none;transition:opacity .15s;}
    .hx-launch-btn:active{opacity:.7;}
    .hx-btn-line{background:#06c755;color:#fff;}
    .hx-btn-web{background:#333;color:#fff;}
    .hx-launch-note{font-size:.85rem;color:#666;margin-top:24px;line-height:1.4;}
  </style>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    /* ===== 設定 ===== */
    const HX_LIFF_ID  = '2007748054-9bD5ZjXA';
    const HX_LIFF_WEB = 'https://liff.line.me/' + HX_LIFF_ID;
    /* 只看產品（純瀏覽版） */
    const HX_WEB_ONLY = 'haoxuan-liff.html'; /* 如要改 index.html 就改這裡 */

    /* 白名單參數：只允許這些 query 被帶到純瀏覽版 (避免 URL 爆長) */
    const ALLOWED_PARAMS = ['cat','sku','ref'];

    function hxParseQuery(){
      const q = {};
      const qs = window.location.search.substring(1);
      if (!qs) return q;
      qs.split('&').forEach(p=>{
        const [k,v] = p.split('=');
        if (!k) return;
        q[decodeURIComponent(k)] = decodeURIComponent(v||'');
      });
      return q;
    }
    function hxBuildAllowedQuery(){
      const obj = hxParseQuery();
      const pairs = [];
      ALLOWED_PARAMS.forEach(k=>{
        if (obj[k]!==undefined && obj[k]!==null && obj[k] !== ''){
          pairs.push(encodeURIComponent(k)+'='+encodeURIComponent(obj[k]));
        }
      });
      return pairs.length ? '?' + pairs.join('&') : '';
    }
    function hxIsInLineApp(){ return /Line\//i.test(navigator.userAgent||''); }

    /* 在 LINE 內：直接跳 LIFF，不帶 query（最穩） */
    function hxAutoLaunchLiff(){ window.location.replace(HX_LIFF_WEB); }

    function hxOpenLiffManually(){
      // 試圖喚起 LINE App（不帶 query）
      window.location.href = `line://app/${HX_LIFF_ID}`;
      // 備援：1.2 秒後跳 LIFF Web
      setTimeout(()=>{ hxAutoLaunchLiff(); },1200);
    }

    (function(){
      if (hxIsInLineApp()){
        hxAutoLaunchLiff();
      }else{
        document.addEventListener('DOMContentLoaded',()=>{
          document.getElementById('hx-launcher-ui').style.display='block';
          document.getElementById('hx-open-line-btn').addEventListener('click',hxOpenLiffManually);
          const webBtn = document.getElementById('hx-open-web-btn');
          webBtn.href = HX_WEB_ONLY + hxBuildAllowedQuery();
        });
      }
    })();
  </script>
</head>
<body>
  <div id="open-external-tip">
    分享或下載失敗？ 請點右上「⋯」選單 → 在瀏覽器開啟
  </div>

  <div id="hx-launcher-ui" class="hx-launch-wrap" style="display:none;">
    <img src="images-web/浩軒13.6.png" alt="浩軒 LOGO" class="hx-launch-logo" />
    <h1 class="hx-launch-title">浩軒產品互動版</h1>
    <p class="hx-launch-desc">
      在 <strong>LINE</strong> 中開啟可加入心願單並分享好友。<br>
      若只想瀏覽產品，可改看網頁版。
    </p>
    <button id="hx-open-line-btn" class="hx-launch-btn hx-btn-line">在 LINE 中開啟互動版</button>
    <a id="hx-open-web-btn" class="hx-launch-btn hx-btn-web" href="#">只要看產品（無分享）</a>
    <p class="hx-launch-note">
      若未自動跳 LINE，可能被手機阻擋；請再按一次。
    </p>
  </div>

  <footer class="site-footer">
    <div class="container-fluid bg-dark py-5 px-0">
      <div class="container d-flex flex-column align-items-center text-center">
        <h5 class="mb-1 fs-2 text-white">Contact us</h5>
        <p class="mb-4 fs-5 text-white-50">Tel : 02-2285-3388</p>
        <hr class="border-light opacity-25 w-75 my-4" />
        <p class="mb-1 fs-5 text-white-50">交屋手冊、錦盒、鎖牌、化妝包、帆布袋、保冰袋、不織布袋、手提袋工廠</p>
        <p class="mb-0 fs-6 text-white-50">© 2025 All Rights Reserved</p>
      </div>
    </div>
  </footer>

  <!-- 外掛 JS 保留 -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</body>
</html>
